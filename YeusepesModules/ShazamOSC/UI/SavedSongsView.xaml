<UserControl x:Class="YeusepesModules.ShazamOSC.UI.SavedSongsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:ui="clr-namespace:YeusepesModules.ShazamOSC.UI"
             Background="#292929">
    <UserControl.Resources>
        <ResourceDictionary>

            <!-- Icons -->
            <Geometry x:Key="spotify_icon">
                M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0m3.669 11.538a.5.5 0 0 1-.686.165
                c-1.879-1.147-4.243-1.407-7.028-.77a.499.499 0 0 1-.222-.973
                c3.048-.696 5.662-.397 7.77.892a.5.5 0 0 1 .166.686m.979-2.178
                a.624.624 0 0 1-.858.205c-2.15-1.321-5.428-1.704-7.972-.932
                a.625.625 0 0 1-.362-1.194c2.905-.881 6.517-.454 8.986 1.063
                a.624.624 0 0 1 .206.858m.084-2.268C10.154 5.56 5.9 5.419
                3.438 6.166a.748.748 0 1 1-.434-1.432c2.825-.857 7.523-.692
                10.492 1.07a.747.747 0 1 1-.764 1.288
            </Geometry>

            <Geometry x:Key="shazam_icon">
                m12.001 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12
                c0-6.627-5.373-12-12-12zm-2.128 16.736c-.016 0-.035 0-.054 0
                -1.34 0-2.567-.484-3.515-1.288l.008.007c-1.158-.985-1.92-2.406
                -2.028-4.006l-.001-.018c-.007-.101-.01-.22-.01-.339
                0-1.439.55-2.749 1.45-3.732l-.004.004c1.142-1.264 3.189-3.225
                3.275-3.309.247-.226.577-.365.94-.365.769 0 1.393.624
                1.393 1.393 0 .386-.157.735-.411.988-.021.02-2.061 1.976
                -3.137 3.164-.449.489-.724 1.144-.724 1.864 0 .057.002.115
                .005.171v-.008c.064.841.464 1.577 1.065 2.082l.005.004
                c.477.376 1.087.603 1.75.603.687 0 1.317-.244 1.808-.65l-.005.004
                c.619-.559 1.372-1.377 1.38-1.386.254-.265.611-.429 1.006-.429
                .769 0 1.393.624 1.393 1.393 0 .355-.133.679-.352.925l.001-.001
                c-.035.035-.852.924-1.572 1.572-.961.843-2.228 1.357-3.615 1.357
                -.018 0-.036 0-.054 0zm8.41-.1c-1.143 1.262-3.189 3.225-3.276 3.309
                -.247.226-.577.365-.94.365-.769 0-1.393-.624-1.393-1.393
                0-.386.157-.735.411-.988.021-.02 2.063-1.977 3.137-3.166
                .449-.489.724-1.144.724-1.863 0-.058-.002-.115-.005-.172v.008
                c-.063-.84-.464-1.576-1.065-2.08l-.005-.004c-.477-.376-1.086-.604
                -1.749-.604-.687 0-1.317.245-1.808.651l.005-.004c-.621.556-1.373 1.376
                -1.38 1.384-.255.276-.619.449-1.024.449-.769 0-1.392-.623-1.392-1.392
                0-.364.14-.696.369-.944l-.001.001c.034-.037.85-.926 1.571-1.573
                .976-.843 2.258-1.356 3.659-1.356 1.359 0 2.606.483 3.577 1.287
                l-.009-.008c1.158.985 1.919 2.407 2.027 4.007l.001.018
                c.007.102.011.222.011.342 0 1.438-.549 2.747-1.448 3.73l.004-.004z
            </Geometry>

            <GeometryGroup x:Key="delete_icon">
                <Geometry>
                    M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5
                m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5
                m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z
                </Geometry>
                <Geometry>
                    M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4
                h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2
                a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13
                a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4z
                M2.5 3h11V2h-11z
                </Geometry>
            </GeometryGroup>

            <!-- Base style for all icon buttons -->
            <Style x:Key="IconButtonBaseStyle" TargetType="Button">
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                <!-- optional: give yourself a little padding so it’s easier to hit -->
                <Setter Property="Padding" Value="4"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <!-- this Border now actually uses the Background for hit-testing -->
                            <Border
          Background="{TemplateBinding Background}"
          BorderBrush="{TemplateBinding BorderBrush}"
          BorderThickness="{TemplateBinding BorderThickness}"
          SnapsToDevicePixels="True">
                                <ContentPresenter
            HorizontalAlignment="Center"
            VerticalAlignment="Center" />
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>


            <!-- Spotify hover → green -->
            <Style x:Key="SpotifyButtonStyle"                   
                   TargetType="Button"
                   BasedOn="{StaticResource IconButtonBaseStyle}">
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Trigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <ColorAnimation 
                                        Storyboard.TargetProperty="(Foreground).(SolidColorBrush.Color)"
                                        To="#1DB954"
                                        Duration="0:0:0.1"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </Trigger.EnterActions>
                        <Trigger.ExitActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <ColorAnimation
                                        Storyboard.TargetProperty="(Foreground).(SolidColorBrush.Color)"
                                        To="White"
                                        Duration="0:0:0.1"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </Trigger.ExitActions>
                    </Trigger>
                </Style.Triggers>
            </Style>

            <!-- Shazam hover → blue -->
            <Style x:Key="ShazamButtonStyle"
                   TargetType="Button"
                   BasedOn="{StaticResource IconButtonBaseStyle}">
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Trigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <ColorAnimation 
                                        Storyboard.TargetProperty="(Foreground).(SolidColorBrush.Color)"
                                        To="#009ADE"
                                        Duration="0:0:0.1"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </Trigger.EnterActions>
                        <Trigger.ExitActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <ColorAnimation
                                        Storyboard.TargetProperty="(Foreground).(SolidColorBrush.Color)"
                                        To="White"
                                        Duration="0:0:0.1"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </Trigger.ExitActions>
                    </Trigger>
                </Style.Triggers>
            </Style>

            <!-- Delete hover → red -->
            <Style x:Key="DeleteButtonStyle"
                   TargetType="Button"
                   BasedOn="{StaticResource IconButtonBaseStyle}">
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Trigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <ColorAnimation 
                                        Storyboard.TargetProperty="(Foreground).(SolidColorBrush.Color)"
                                        To="#E74A4A"
                                        Duration="0:0:0.1"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </Trigger.EnterActions>
                        <Trigger.ExitActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <ColorAnimation
                                        Storyboard.TargetProperty="(Foreground).(SolidColorBrush.Color)"
                                        To="White"
                                        Duration="0:0:0.1"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </Trigger.ExitActions>
                    </Trigger>
                </Style.Triggers>
            </Style>

            <!-- Song card template -->
            <DataTemplate x:Key="SongCardTemplate"
                          DataType="{x:Type ui:SavedSong}">
                <Border CornerRadius="4"
                        Background="#1E1E1E"
                        Margin="6">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="56"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="44"/>
                            <ColumnDefinition Width="44"/>
                            <ColumnDefinition Width="44"/>
                        </Grid.ColumnDefinitions>

                        <!-- Cover art -->
                        <Image Grid.Column="0"
                               Source="{Binding CoverArtUrl}"
                               Width="48" Height="48"
                               Margin="4"
                               Stretch="UniformToFill"/>

                        <!-- Title & artist -->
                        <StackPanel Grid.Column="1"
                                    VerticalAlignment="Center"
                                    Margin="8,0">
                            <TextBlock Text="{Binding Title}"
                                       Foreground="White"
                                       FontSize="16"
                                       FontWeight="SemiBold"
                                       TextTrimming="CharacterEllipsis"/>
                            <TextBlock Text="{Binding Artist}"
                                       Foreground="LightGray"
                                       FontSize="14"
                                       Margin="0,2,0,0"
                                       TextTrimming="CharacterEllipsis"/>
                        </StackPanel>

                        <!-- Spotify -->
                        <Button Grid.Column="2"
                                Style="{StaticResource SpotifyButtonStyle}"
                                Command="{Binding OpenSpotifyCommand}"
                                ToolTip="Open in Spotify">
                            <Path Data="{StaticResource spotify_icon}"
                                  Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                                  Stretch="Uniform"
                                  Width="24" Height="24"/>
                        </Button>

                        <!-- Shazam -->
                        <Button Grid.Column="3"
                                Style="{StaticResource ShazamButtonStyle}"
                                Command="{Binding OpenShazamCommand}"
                                ToolTip="Open in Shazam">
                            <Path Data="{StaticResource shazam_icon}"
                                  Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                                  Stretch="Uniform"
                                  Width="24" Height="24"/>
                        </Button>

                        <!-- Delete -->
                        <Button Grid.Column="4"
                                Style="{StaticResource DeleteButtonStyle}"
                                Command="{Binding DataContext.DeleteSongCommand,
                                                  RelativeSource={RelativeSource AncestorType=UserControl}}"
                                CommandParameter="{Binding}"
                                ToolTip="Delete song">
                            <Path Data="{StaticResource delete_icon}"
                                  Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                                  Stretch="Uniform"
                                  Width="24" Height="24"/>
                        </Button>
                    </Grid>
                </Border>
            </DataTemplate>

        </ResourceDictionary>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <ItemsControl ItemsSource="{Binding Songs}"
                      ItemTemplate="{StaticResource SongCardTemplate}"
                      Margin="4"/>
    </ScrollViewer>
</UserControl>
