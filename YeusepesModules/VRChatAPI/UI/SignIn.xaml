<UserControl x:Class="YeusepesModules.VRChatAPI.UI.SignIn"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:YeusepesModules.VRChatAPI.UI">
    <UserControl.Resources>
        <!-- VRChat Logo Geometry -->
        <GeometryGroup x:Key="VRChatLogo">
            <Geometry>
                M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.94-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z
            </Geometry>
        </GeometryGroup>

        <!-- VRChat Icon for Module - Simplified VR Headset -->
        <GeometryGroup x:Key="VRChatIcon">
            <Geometry>
                M8 4C6.9 4 6 4.9 6 6v8c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2H8zm2 2h4v2h-4V6zm0 4h4v2h-4v-2zm-2 2h2v2H8v-2z
            </Geometry>
        </GeometryGroup>

        <!-- Button Style -->
        <Style TargetType="Button" x:Key="VRChatButtonStyle">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <Border Background="{TemplateBinding Background}"
                                    CornerRadius="25"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch">
                                <ContentPresenter HorizontalAlignment="Center"
                                                  VerticalAlignment="Center" />
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Background" Value="#1DB954"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#1ed760"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#1aa34a"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Account Button Style -->
        <Style TargetType="Button" x:Key="AccountButtonStyle">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <Border Background="{TemplateBinding Background}"
                                    CornerRadius="25"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch">
                                <ContentPresenter HorizontalAlignment="Center"
                                                  VerticalAlignment="Center" />
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Background" Value="#383838"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="White"/>
                    <Setter Property="Foreground" Value="Black"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Sign Out Button Style -->
        <Style TargetType="Button" x:Key="SignOutButtonStyle">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Grid>
                            <Border Background="{TemplateBinding Background}"
                                    CornerRadius="25"
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Stretch">
                                <ContentPresenter HorizontalAlignment="Center"
                                                  VerticalAlignment="Center" />
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Background" Value="#383838"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E74A4A"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>
    
    <StackPanel>
        <Viewbox Stretch="Uniform" Margin="0,-40,0,10">
            <Grid>
                <!-- Signed Out State -->
                <Grid x:Name="SignedOutState" Visibility="Visible">
                    <Button Style="{StaticResource VRChatButtonStyle}"
                            Click="OnSignInClick"
                            Width="400" Height="100">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- VRChat Logo -->
                            <Path Grid.Column="0"
                                  Data="{StaticResource VRChatLogo}"
                                  Fill="White"
                                  Width="40" Height="40"
                                  Margin="20,0,20,0"
                                  VerticalAlignment="Center"/>
                            
                            <!-- Text -->
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock Text="Sign in to VRChat"
                                           FontSize="24"
                                           FontWeight="Bold"
                                           Foreground="White"
                                           HorizontalAlignment="Center"/>
                                <TextBlock Text="Connect your VRChat account"
                                           FontSize="14"
                                           Foreground="White"
                                           Opacity="0.8"
                                           HorizontalAlignment="Center"
                                           Margin="0,5,0,0"/>
                            </StackPanel>
                        </Grid>
                    </Button>
                </Grid>

                <!-- Signed In State -->
                <Grid x:Name="SignedInState" 
                      HorizontalAlignment="Stretch"
                      VerticalAlignment="Stretch"
                      Margin="-200,0,0,0"
                      Visibility="Hidden">
                    <StackPanel Orientation="Horizontal"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center">
                        <!-- Profile Picture -->
                        <Grid>
                            <Ellipse Width="120" Height="120" Fill="#D9D9D9"/>
                            <Ellipse Width="120" Height="120">
                                <Ellipse.Fill>
                                    <ImageBrush x:Name="ProfileImageBrush" Stretch="UniformToFill"/>
                                </Ellipse.Fill>
                            </Ellipse>
                        </Grid>
                        
                        <Rectangle Width="30"/>
                        
                        <!-- User Info -->
                        <StackPanel HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    Margin="20,0,0,0">
                            <!-- Greeting -->
                            <StackPanel Orientation="Horizontal" Margin="20,20,0,0">
                                <TextBlock Text="Hey, "
                                           x:Name="HeyText"
                                           Foreground="White"
                                           FontSize="32"
                                           FontWeight="Light"/>
                                <TextBlock Text="{Binding Path=DisplayName}"
                                           x:Name="UserName"
                                           Foreground="White"
                                           FontSize="32"
                                           FontWeight="Bold"/>
                                <TextBlock Text="!"
                                           x:Name="ExclamationText"
                                           Foreground="White"
                                           FontSize="32"
                                           FontWeight="Bold"/>
                            </StackPanel>
                            
                            <!-- Status -->
                            <StackPanel Orientation="Horizontal" Margin="30,0,50,10">
                                <TextBlock Text="Status: "
                                           x:Name="StatusLabelText"
                                           Foreground="White"
                                           FontSize="16"
                                           FontWeight="Regular"/>
                                <TextBlock x:Name="StatusText"
                                           Foreground="White"
                                           FontSize="16"
                                           FontWeight="Bold"/>
                            </StackPanel>

                            <!-- Buttons -->
                            <StackPanel Orientation="Horizontal"
                                        HorizontalAlignment="Stretch"
                                        VerticalAlignment="Bottom"
                                        Margin="0,20,0,40">
                                <!-- Your Account Button -->
                                <Button Style="{StaticResource AccountButtonStyle}"
                                        Click="OnYourAccountClick"
                                        Width="150" Height="50">
                                    <TextBlock Text="Your Account"
                                               x:Name="YourAccountText"
                                               FontSize="16"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"/>
                                </Button>
                                
                                <Rectangle Width="20"/>
                                
                                <!-- Sign Out Button -->
                                <Button Style="{StaticResource SignOutButtonStyle}"
                                        Click="OnSignOutClick"
                                        Width="120" Height="50">
                                    <TextBlock Text="Sign Out"
                                               x:Name="SignOutText"
                                               FontSize="16"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"/>
                                </Button>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Grid>

                <!-- Loading Spinner Overlay -->
                <Grid x:Name="SpinnerOverlay" 
                      Visibility="Collapsed" 
                      Background="#80000000">
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Canvas Width="100" Height="100">
                            <!-- Circular Spinner -->
                            <Path x:Name="SpinnerArc"
                                  Data="M50,10 A40,40 0 1 1 49.99,10"
                                  StrokeThickness="8"
                                  StrokeStartLineCap="Round"
                                  StrokeEndLineCap="Round">
                                <Path.Stroke>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0" MappingMode="RelativeToBoundingBox">
                                        <GradientStop Color="#1DB954" Offset="0"/>
                                        <GradientStop Color="Transparent" Offset="1"/>
                                    </LinearGradientBrush>
                                </Path.Stroke>
                                <Path.RenderTransform>
                                    <RotateTransform x:Name="SpinnerRotateTransform" CenterX="50" CenterY="50"/>
                                </Path.RenderTransform>
                            </Path>
                        </Canvas>
                        <TextBlock x:Name="SpinnerText"
                                   Text="Signing in..."
                                   Foreground="White"
                                   FontSize="20"
                                   HorizontalAlignment="Center"
                                   Margin="0,20,0,0"/>
                    </StackPanel>
                    <!-- Continuous rotation animation -->
                    <Grid.Triggers>
                        <EventTrigger RoutedEvent="Grid.Loaded">
                            <BeginStoryboard>
                                <Storyboard RepeatBehavior="Forever">
                                    <DoubleAnimation Storyboard.TargetName="SpinnerRotateTransform"
                                                     Storyboard.TargetProperty="Angle"
                                                     From="0" To="360" Duration="0:0:1"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </Grid.Triggers>
                </Grid>
            </Grid>
        </Viewbox>
        
        <!-- Advanced Credentials Section -->
        <local:AdvancedCredentials x:Name="AdvancedCredentialsSection"
                                   Margin="0,20,0,0"/>
    </StackPanel>
</UserControl>